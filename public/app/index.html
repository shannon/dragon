<!DOCTYPE html>
<script src="/bower_components/angular/angular.min.js"></script>
<script src="/bower_components/angular-animate/angular-animate.min.js"></script>
<script src="/bower_components/angular-cookies/angular-cookies.min.js"></script>
<script src="/bower_components/angular-aria/angular-aria.min.js"></script>
<script src="/bower_components/angular-touch/angular-touch.min.js"></script>

<script src="/bower_components/hammerjs/hammer.js"></script>
<script src="/bower_components/angular-material/angular-material.js"></script>

<script src="/lib/angular-import.js"></script>
<script src="/lib/angular-recursion.js"></script>
<script src="/lib/angular-ui-router.min.js"></script>
<script src="/lib/angular.hammer.min.js"></script>
<script src="/lib/angular-uuid4.min.js"></script>
<script src="/lib/screenfull.min.js"></script>

<link href="/bower_components/angular-material/angular-material.css" rel="stylesheet">
<!--<link href="/lib/material-design-iconic-font/css/material-design-iconic-font.min.css" rel="stylesheet">-->
<!--<link href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">-->

<link href="/common/api/" rel="import">
<link href="/common/avatar/" rel="import">
<link href="/common/board/" rel="import">

<link href="error/" rel="import">
<!--<link href="welcome/" rel="import">-->
<!--<link href="home/" rel="import">-->
<link href="game/" rel="import">

<script src="/dragon.js"></script>
<script src="app.js"></script>
<style>
  
  html {
  box-sizing: border-box;
  }
  *, *:before, *:after {
    box-sizing: inherit;
  }
  
  button.material-button-inner {
    padding: 15px;
  }
  
  md-sidenav {
    margin-top: 16px;
  }
  
  md-sidenav .md-button {
    border-radius: 0 !important;
  }
  
  md-sidenav .md-button.active {
    background: rgba(158, 158, 158, 0.2);
  }
  
  .backsheet {
    background-color: #ececec !important;
  }
  
  .game-card {
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
    background: #fff;
  }
  
  .new-game {
    position: fixed;
    right: 32px;
    bottom: 32px;
  }
  
  .placeholder {
    color: rgba(0, 0, 0, 0.36);
  }
  
  .placeholder h2, .placeholder h4 {
    margin-bottom: 0;
    font-weight: normal;
  }
  
  .text-muted {
    color: rgba(0, 0, 0, 0.36);
  }
  
  
  [ui-view="content"].ng-enter, [ui-view="content"].ng-leave {
    -webkit-transition:all .5s ease-in-out;
      -moz-transition:all .5s ease-in-out;
      -o-transition:all .5s ease-in-out;
      transition:all .5s ease-in-out;
  }
  
  [ui-view="content"].ng-enter {
    opacity: 0;
    -webkit-transform:scale3d(0.5, 0.5, 0.5);
    -moz-transform:scale3d(0.5, 0.5, 0.5);
    transform:scale3d(0.5, 0.5, 0.5);
  }
  
  [ui-view="content"].ng-enter-active {
    opacity: 1;
    -webkit-transform:scale3d(1, 1, 1);
    -moz-transform:scale3d(1, 1, 1);
    transform:scale3d(1, 1, 1);
  }
  
  [ui-view="content"].ng-leave {
    opacity: 1;
    -webkit-transform:translate3d(0, 0, 0);
    -moz-transform:translate3d(0, 0, 0);
    transform:translate3d(0, 0, 0);
  }
  
  [ui-view="content"].ng-leave-active {
    opacity: 0;
  }
  
</style>
<template id="app.tpl.html">
  <div layout="column" flex>
  
    <md-toolbar class="md-whiteframe-z1">
      <h2 class="md-toolbar-tools" layout="row">
        <div>Dragon</div>
        <div flex></div>
        <a class="md-button md-blue-theme" ng-click="showBottomSheet($event)">Actions</a>
      </h2>
    </md-toolbar>
    
    <div layout="row" flex>
    
      <md-sidenav class="md-sidenav-left md-whiteframe-z2" md-component-id="left" md-is-locked-open="$media('md')"
        layout="column">
        <md-button ui-sref="app" ui-sref-active-eq="active">Games</md-button>
        <div flex>
          
        </div>
        
        <div class="md-padding">
          <div ng-show="!support.indexedDB">
            Your browser does not support offline storage.
          </div>
          <div ng-show="!support.cookies">
            Enable cookies to enable offline support
          </div>
          <md-checkbox ng-model="data.saveLocal" aria-label="Save Games to Local Storage"
            ng-show="support.cookies && support.indexedDB">
            Save Games to Local Storage
          </md-checkbox>
        </div>
        
      </md-sidenav>
      
      <div flex style="position: relative;">
        <div ui-view="content" layout="column" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0">
          <md-content class="placeholder backsheet" flex layout="column" layout-fill layout-align="center center"
            ng-hide="games.length">
            <h2>No Games</h2>
            <h4>Create one now to start playing.</h4>
          </md-content>
          
          <md-content class="backsheet" flex ng-show="games.length">
            <md-card class="game-card" ng-repeat="game in games" ng-click="openGame(game._id)">
              <dragon-board game="game" static="true"></dragon-board>
              <div layout="row" layout-align="start end">
                <h3 contenteditable ng-model="game.metadata.title" flex></h3>
                <div class="text-muted">{{game.created | date:'mediumDate'}}</div>
              </div>
            </md-card>
          </md-content>
          
          <md-button class="md-fab md-warn new-game" aria-label="New game" ng-click="newGame()">
            +
          </md-button>
        </div>
        
      </div>
      
    </div>
  </div>
</template>

<template id="bottom-sheet.tpl.html">
  <md-bottom-sheet class="md-list md-has-header">
    <md-subheader>Game Actions</md-subheader>
    <md-list>
      <md-item ng-repeat="item in items">
        <md-button aria-label="{{item.name}}" ng-click="listItemClick($index)">
          <!-- Using custom inline icon until md-icon is ready. DONT USE ME! -->
          <!--<md-inline-list-icon icon="{{item.icon}}"></md-inline-list-icon>-->
          <span class="md-inline-list-icon-label">{{ item.name }}</span>
        </md-button>
      </md-item>
    </md-list>
  </md-bottom-sheet>
</template>